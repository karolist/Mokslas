
══════════════════════════════════════
         ОРГАНИЗАЦИЯ ПАМЯТИ
══════════════════════════════════════
 Память  микропроцессора  intel  80386
разделена  на  8-ми  битовые  величины
(байты),16-ти битовые  величины(слова)
и  32-х  битовые(двойные  слова).Слова
хранятся в двух последовательных  бай-
тах памяти,когда байт младшего порядка
находится по младшим адресам ,а  стар-
ший  байт  в  старших  адресах.Двойные
слова хранятся в четырех  последовате-
льных байтах памяти с байтом  младшего
порядка  в самом младшем адресе,а байт
старшего порядка в самом высоком адре-
се.Адресом  слова  или  двойного слова
является адрес байта младшего порядка.
 Кроме  этих  основных  типов  данных,
80386 поддерживает  два больших  блока
памяти: страницы и сегменты.Память мо-
жет быть разбита на один или несколько
сегментов различной длины,которые  мо-
гут быть  перенесены на  диск или  де-
литься между программами.Память  также
может  быть  организована  в  одну или
более  4Кбайтных  страниц.Наконец,сег-
ментация и разбиение(памяти) на  стра-
ницы могут быть объединены,давая  воз-
можность   использовать   преймущества
обоих  систем.80386   поддерживает   и
страницы,и  сегменты,чтобы  обеспечить
максимальную  гибкость   пользователю.
Сегментация и постраничная организация
являются  дополнительными  средствами.
Сегментация  полезна  при  организации
памяти в логические модули,и  является
инструментом для програмиста  приклад-
ных программ,в  то время,как  страницы
используются  системным   програмистом
для управления физической памятью.
══════════════════════════════════════
       АДРЕСНЫЕ ПРОСТРАНСТВА
══════════════════════════════════════
 80386  имеет  три  различных адресных
пространства:логическое,линейное и фи-
зическое.Логический  адрес(его   также
называют  виртуальным  адресом)состоит
из селектора  сегмента и  смещения.Се-
лектор  представляет  собой содержимое
сегментного регистра.Смещение формиру-
ется путем суммирования всех  адресных
компонентов(Базы,Индекса,Смещения)   в
исполнительный адрес(т.е. исполнитель-
ный адрес определяется в любом  режиме
адресации).
 Поскольку каждая  задача 80386  имеет
максимум 16К(2 в 14 минис 1)селекторов
а смещения  могут быть  4Гигабайта(2 в
32 бит),это дает полностью 2 в 46  бит
или  64Терабайт  логического адресного
пространства   на   задачу.Программист
"видит"  данное  виртуальное  адресное
пространство .
--------------------------------------
 Блок сегментации переводит логическое
адресное пространство в 32-х разрядное
линейное  адресное   пространство.Если
блок разбиения на страницы отсутствует
то в  этом случае  32-битовый линейный
адрес соответствует физическому адресу
Блок разбиения  на страницы  переводит
(преобразовывает)линейное     адресное
пространство  в  физическое  адресное.
Физический адрес- это то,что появляет-
ся на адресной шине.
 Главным  отличием  между  РЕАЛЬНЫМ  и
ЗАЩИЩЕННЫМ  режимом  является   то,как
блок сегментации выполняет  преобразо-
вание логического  адреса в  линейный.
В  РЕАЛЬНОМ  режиме,блок   сегментации
сдвигает селектор  влево на  4 бита  и
прибавляет сформированный в любом  ре-
жиме  адресации  эффективный  адрес  к
сдвигу для  образования линейного  ад-
реса.В ЗАЩИЩЕННОМ режиме каждый селек-
тор имеет соотнесенный с ним  линейный
базовый адрес.Он хранится в одной  или
двух таблицах операционных систем(т.е.
ЛОКАЛЬНОЙ ТАБЛИЦЕ ДЕСКРИПТОРА или ГЛО-
БАЛЬНОЙ ТАБЛИЦЕ  ДИСКРИПТОРА).Линейный
базовый  адрес  селектора прибавляется
к смещению для образования  оконечного
линейного адреса.
 На  рисунке  представлена взаимосвязь
между различными адресными пространст-
вами.
══════════════════════════════════════
  ИСПОЛЬЗОВАНИЕ СЕГМЕНТНОГО РЕГИСТРА
══════════════════════════════════════
 Основной структурой данных,используе-
мых  для  организации  памяти,является
сегмент.В 80386 сегменты  представляют
собой различные  по размеру  блоки ли-
нейных  адресов,которые  имеют опреде-
ленные  соотнесенные  с  ним признаки.
Существуют три  основных типа  сегмен-
тов:кода,данных и стека.Сегменты  име-
ют различные  размеры,и могут  быть от
одного байта до 4 Гигабайт.
 Для обеспечения компактного кодирова-
ния команд и улучшения рабочих  харак-
теристик процессора,командам нет необ-
ходимости всегда четко определять  ка-
кой  сегментный  регистр используется.
Сегментные регистры выбираются автома-
тически по умолчанию в соответствии  с
правилами,представленными  в   таблице
 ПРАВИЛА  ВЫБОРА  СЕГМЕНТНОГО РЕГИСТРА
(для осмота нажмите клавишу < F10  >).
Обычно,ссылки на данные используют се-
лектор,который  содержится  в регистре
DS.Ссылки на данные в стеке используют
регистр  SS  и  регистр  SP в качестве
смещения,а  выборки  команд используют
регистр  CS,cодержание  указателя   IP
команд обеспечивает смещение.Специаль-
ные префиксы отмены сегментного регис-
тра позволяют явно использовать задан-
ный сегментный регистр,и отменять  не-
явные правила,перечисленные в таблице.
Префиксы  отмены  позволяют  также ис-
пользовать сегментные регистрыFS и GS.
 Не  существует  никаких  ограничений,
касающихся перекрытия любых сегментов,
т.е. сегменты  в памяти  перекрываются
произвольным образом.Таким образом,все
6 сегментов могут иметь базовый  адрес
установленный на  ноль и  создать сис-
тему с 4-х Гигабайтным адресным  прос-
транством.Это создает систему,в  кото-
рой виртуальное адресное  пространство
является таким же,как и линейное адрес
ное прстранство.Дальнейшие подробности
сегментации  обсуждаются   в   разделе
ЗАЩИЩЕННЫЙ РЕЖИМ подразделе АРХИТЕКТУ-
РА ЗАЩИЩЕННОГО РЕЖИМА.




















.
