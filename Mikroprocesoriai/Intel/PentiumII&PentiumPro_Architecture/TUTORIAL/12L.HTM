<HTML>
<HEAD>
<TITLE>Topic 12</TITLE>
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000" LINK="#CC00CC" VLINK="#CC00CC" ALINK="#CC00CC">
<SCRIPT language="JavaScript">
<!--
if (document.location==parent.document.location)
document.write("<CENTER><H3>This page is part of the Optimizing for Pentium(R) II and Pentium Pro Processors tutorial. To start the tutorial, please open the <a href=\"start.htm\">START.HTM</a> page in the same directory.</H3></CENTER>")
//-->
</SCRIPT>

<P><a name="top"></a><font size="+1"><b>П</b></font>роцессор выбирает команды последовательно, пока не встретит <A HREF="javascript:parent.showglos('branch')">ветвление</a>.

<P>
Если данная команда ветвления выполняется не впервые, то процессор пытается предсказать следующее значение счетчика 
команд (IP) с помощью механизма <A HREF="javascript:parent.showglos('dynbrpred')">динамического предсказания ветвлений</a>,
используя историю прошлых ветвлений.
Информация о прошлых ветвлениях хранится в буфере адресов ветвления, имеющем 512 входов.

<P>Если данное ветвление встретилось впервые или информация о ветвлении уже вытеснена из буфера адресов ветвления, 
то используется алгоритм <A HREF="javascript:parent.showglos('staticbrpred')">статического предсказания ветвления</a>. 
Статическое предсказание становится возможно позже, чем динамическое - только на этапе декодирования.

<P><font size="+1"><b>В</b></font>ыберите <B>Статическое</B> или <B>Динамическое </B>и нажмите кнопку <B>"Показать"</B>, чтобы посмотреть влияние статического и динамического предсказания ветвления на один и тот же поток команд, когда ветвление выполняется.

<br>
<br>
<br>
<br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
<a name="s_msg1"></a>
<br>
32 байта выбираются с адреса 0040h, на который указывает счетчик команд (IP). Следующие 32 байта (0060h) входят в конвейер.<br>

Затем процессор помечает начало и конец каждой команды в первых 16 байтах и проверяет наличие истории каждой из них в буфере адресов
ветвления. <br>
<a href="#top" target="_self">К началу страницы</a>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>

<a name="s_msg2"></a>
<br>
В буфере адресов ветвления не найден адрес ни одной из команд, содержащихся в данных 16 байтах. О данных командах может быть сделано
любое предсказание. <br>
Сейчас данные 16 байтов готовы к передаче в декодер.  <br>
<a href="#top" target="_self">К началу страницы</a>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>

<a name="s_msg3"></a>
<br>
Декодер начинает распознавание каждой команды в первых 16 байтах. <br>
В то же время процессор продолжает помечать начало и конец команд и проверять содержимое буфера адресов ветвления для вторых 16
байтов.  <br>
<a href="#top" target="_self">К началу страницы</a>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>

<a name="s_msg4"></a>
<br>
Декодер распознал инструкции (их границы помечены на рисунке) в первых 16 байтах. <br>
Ветвление, содержащееся во вторых 16 байтах (выделено розовым), не распознано, так как буфер адресов ветвления не содержит историю для
данного адреса. <br>
Процессор посылает вторые 16 байтов в декодер и начинает обработку следующей кэш-линии. <br>
<a href="#top" target="_self">К началу страницы</a>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>

<a name="s_msg5"></a>
<br>
Пока процессор обрабатывает первые 16 байтов следующей кэш-линии, декодер распознает ветвление в предыдущих 16 байтах.<br> 
Адрес 1F80h, на который будет передано управление в результате ветвления (адрес ветвления), предсказывается при помощи алгоритма
статического предсказания. Затем обновляется значение счетчика команд (IP). Команды, уже вошедшие в конвейер, будут отброшены, и
произойдет выборка новых команд. <br>
<a href="#top" target="_self">К началу страницы</a>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>

<a name="s_msg6"></a>
<br>
Команды выбираются с предсказанного адреса ветвления (1F80h). Они заменяют команды, уже вошедшие в конвейер, но отброшенные.<br>
<a href="#top" target="_self">К началу страницы</a>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>

<a name="d_msg1"></a>
<br>
32 байта выбираются с адреса 0040h, на который указывает счетчик команд (IP). Следующие 32 байта (0060h) входят в конвейер.<br> 
Затем процессор помечает начало и конец каждой команды в первых 16 байтах и проверяет наличие истории каждой из них в буфере адресов
ветвления. <br>
<a href="#top" target="_self">К началу страницы</a>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>

<a name="d_msg2"></a>
<br>
В буфере адресов ветвления не найден адрес ни одной из команд, содержащихся в данных 16 байтах. О данных командах может быть сделано
любое предсказание. <br>
Сейчас данные 16 байтов готовы к передаче в декодер. <br>
<a href="#top" target="_self">К началу страницы</a>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>

<a name="d_msg3"></a>
<br>
Декодер начинает распознавание каждой команды в первых 16 байтах.<br> 
В то же время процессор продолжает помечать начало и конец команд и проверять содержимое буфера адресов ветвления для вторых 16
байтов. <br>
<a href="#top" target="_self">К началу страницы</a>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>

<a name="d_msg4"></a>
<br>
Декодер распознал инструкции (их границы помечены на рисунке) в первых 16 байтах.<br> 
Ветвление, содержащееся во вторых 16 байтах (выделено розовым), не распознано, так как буфер адресов ветвления не содержит историю для
данного адреса.<br> 
Процессор посылает вторые 16 байтов в декодер и начинает обработку следующей кэш-линии. <br>
<a href="#top" target="_self">К началу страницы</a>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>

<a name="d_msg5"></a>
<br>
Обновляется значение счетчика команд (IP) и новые команды выбираются с предсказанного адреса ветвления. Они заменяют команды, уже
вошедшие в конвейер, но отброшенные. <br>
<a href="#top" target="_self">К началу страницы</a>

<p>&nbsp;<br>
<p>&nbsp;<br>
<p>&nbsp;<br>
<p>&nbsp;<br>
<p>&nbsp;<br>
<p>&nbsp;<br>
<p>&nbsp;<br>
<p>&nbsp;<br>
<p>&nbsp;<br>
<p>&nbsp;<br>
<p>&nbsp;<br>
<p>&nbsp;<br>
<p>&nbsp;<br>
<p>&nbsp;<br>
<p>&nbsp;<br>
<p>&nbsp;<br>

</BODY>
</HTML>

